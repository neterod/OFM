!function(){"use strict";var s=require("gulp"),e=require("gulp-uglify"),i=require("gulp-less"),r=require("gulp-csslint"),t=require("gulp-csslint-less-reporter"),a=require("browser-sync").create(),n=require("gulp-htmlmin"),o=require("gulp-jshint"),c=require("gulp-jscs"),l=require("gulp-notify"),p=require("gulp-nunjucks"),u=require("gulp-concat"),f=require("gulp-imagemin"),d=require("gulp-rename"),h=require("gulp-sourcemaps"),m=require("gulp-whitespace"),b=require("gulp-cached"),v=require("gulp-remember"),j="../dist",g=j+"/js",$=["../src/js/jquery/jquery-1.11.2.min.js","../src/js/jquery/jquery.flexslider.js","../src/js/jquery/jquery.printElement.js"],w=g,k="jquery.min.js",y=["../src/js/bootstrap/affix.js","../src/js/bootstrap/alert.js","../src/js/bootstrap/button.js","../src/js/bootstrap/carousel.js","../src/js/bootstrap/collapse.js","../src/js/bootstrap/dropdown.js","../src/js/bootstrap/modal.js","../src/js/bootstrap/scrollspy.js","../src/js/bootstrap/tab.js","../src/js/bootstrap/transition.js"],q=g,x="bootstrap.min.js",D=["../src/js/ie/html5shiv.min.js","../src/js/ie/respond.min.js"],P=g,E="ie.min.js",T=["../src/js/plugins/accessibility-nav.js","../src/js/plugins/mobile-nav-height.js","../src/js/plugins/convert-svg-inline.js","../src/js/plugins/mobile-tables.js","../src/js/main.js"],M=g,C=["../src/js/plugins/mobile-nav-height.js","../src/js/main.js"],S="../src/less/bootstrap/bootstrap.less",N="../src/less/main.less",R=j+"/css/";s.task("compresslibraries",function(){s.src($).pipe(u(k)).pipe(e()).pipe(s.dest(w)),s.src(y).pipe(u(x)).pipe(e()).pipe(s.dest(q)),s.src(D).pipe(u(E)).pipe(e()).pipe(s.dest(P))}),s.task("compressjs",["lint","jscs"],function(){s.src(T).pipe(h.init()).pipe(v("compressfiles")).pipe(u("main.min.js")).pipe(e({mangle:!1})).pipe(h.write("./")).pipe(s.dest(M))}),s.task("compileimages",function(){return s.src("../src/images/*").pipe(f()).pipe(s.dest("../dist/images"))}),s.task("jscs",function(){return s.src(C).pipe(m({removeTrailing:!0})).pipe(c()).pipe(c.reporter()).pipe(c.reporter("fail")).on("error",l.onError({message:"JSCS failed."}))}),s.task("lint",function(){return s.src(C).pipe(o(".jshintrc")).pipe(o.reporter("jshint-stylish")).pipe(o.reporter("fail")).on("error",l.onError({message:"JSHint failed."}))}),s.task("compilecss",function(){return s.src(N).pipe(v("lessfiles")).pipe(h.init()).pipe(d("main.min.css")).pipe(i({compress:!0})).pipe(r("../src/less/.csslintrc")).pipe(t()).pipe(h.write("./")).pipe(s.dest(R))}),s.task("compilecssbootstrap",function(){return s.src(S).pipe(i({compress:!0})).pipe(d("bootstrap.min.css")).pipe(s.dest(R))}),s.task("minifyhtml",function(){return s.src("../src/*.html").pipe(p.compile()).pipe(n({collapseWhitespace:!0})).pipe(s.dest(j))}),s.task("server",[],function(){b.caches={},a.init({server:{baseDir:j},open:!1}),a.watch(R+"*.css",function(s,e){"change"===s&&a.reload(R+"*.css")}),s.watch("../src/less/*.less",["compilecss"]),s.watch(T,["jscs","lint","compressjs"]),s.watch("../src/**/*.html",["minifyhtml"]),s.watch([j+"/*.html",M+"/*.js"]).on("change",a.reload)}),s.task("default",["server","jscs","compileimages","compressjs","compilecss","compilecssbootstrap","compresslibraries"])}();